<h2 id="section">1. 线性回归</h2>

<p>在一个标准的线性回归问题中，我们有<script type="math/tex">n</script>个数据点<script type="math/tex">\left\{x_1,x_2,...,x_n\right\}</script>，以及对应的<script type="math/tex">\left\{y_1,y_2,...,y_n\right\}</script></p>

<p>且<script type="math/tex">x_i \in R^{k*1}</script>，<script type="math/tex">y_i \in R</script></p>

<p>而线性回归中，给定<script type="math/tex">x_i</script>和参数<script type="math/tex">\beta \in R^{k*1}</script>，<script type="math/tex">y_i</script>的条件分布设定为</p>

<p>\begin{align}
y_i = x_i^T\beta + \epsilon_i \\
\end{align}</p>

<p>其中，<script type="math/tex">\epsilon_i \sim N(0, \sigma^2)</script></p>

<p>因此，<script type="math/tex">y_i \sim N(x_i^T\beta, \sigma^2)</script></p>

<p>使用符号<script type="math/tex">X</script>表示一个<script type="math/tex">n</script>行<script type="math/tex">k</script>列的矩阵，第<script type="math/tex">i</script>个行向量代表<script type="math/tex">x_i^T</script></p>

<p>使用符号<script type="math/tex">y</script>表示大小为<script type="math/tex">n</script>的向量，第<script type="math/tex">i</script>个元素代表<script type="math/tex">y_i</script></p>

<p>频率方法可直接得到一个解</p>

<p>\begin{align}
\hat{\beta} = (X^TX)^{-1}X^Ty
\end{align}</p>

<h2 id="section-1">2. 共轭先验</h2>

<p>在贝叶斯方法中，我们还需要补充先验，在那之前先整理似然函数</p>

<p>\begin{align}
P(y|X,\beta,\sigma^2) &amp;= \prod_{i=1}^nN(x_i^T\beta, \sigma^2) \\
&amp;= \left(\frac{1}{\sigma\sqrt{2\pi}}\right)^nexp\left(-\frac{\sum_{i=1}^n(y_i - x^T_i\beta)^2}{2\sigma^2}\right)\\
&amp;= \left(\frac{1}{\sigma\sqrt{2\pi}}\right)^nexp\left(-\frac{(y-X\beta)^T(y-X\beta)}{2\sigma^2}\right)
\end{align}</p>

<p>去掉常数，有</p>

<p>\begin{align}
P(y|X,\beta,\sigma^2) \propto \sigma^{-n}exp\left(-\frac{(y-X\beta)^T(y-X\beta)}{2\sigma^2}\right)
\end{align}</p>

<p>将<script type="math/tex">(y-X\beta)^T(y-X\beta)</script>改写形式</p>

<p>\begin{align}
(y-X\beta)^T(y-X\beta) = (y-X\hat{\beta})^T(y-X\hat{\beta}) + (\beta - \hat{\beta})^T(X^TX)(\beta - \hat{\beta})
\end{align}</p>

<p>令</p>

<p>\begin{align}
v &amp;= n - k \\
vs^2 &amp;= (y-X\hat{\beta})^T(y-X\hat{\beta}) 
\end{align}</p>

<p>于是我们得到一个新形式的似然函数</p>

<p>\begin{align}
P(y|X,\beta,\sigma^2) &amp; \propto \sigma^{-n}exp\left(-\frac{vs^2 + (\beta-\hat{\beta})^T(X^TX)(\beta-\hat{\beta})}{2\sigma^2}\right) \\
&amp; \propto \sigma^{-n}exp\left(-\frac{vs^2 }{2\sigma^2}\right)exp\left(-\frac{(\beta-\hat{\beta})^T(X^TX)(\beta-\hat{\beta})}{2\sigma^2}\right) \\
&amp; \propto \left[(\sigma^2)^{-v/2}exp\left(-\frac{vs^2 }{2\sigma^2}\right)\right] \left[(\sigma^2)^{-k/2}exp\left(-\frac{(\beta-\hat{\beta})^T(X^TX)(\beta-\hat{\beta})}{2\sigma^2}\right)\right]
\end{align}</p>

<p>令<script type="math/tex">v_0,s_0</script>为<script type="math/tex">v,s</script>的先验值，随后为了使先验共轭，令先验的形式与似然函数对应</p>

<p>\begin{align}
P(\beta,\sigma^2) = P(\sigma^2)P(\beta|\sigma^2)
\end{align}</p>

<p>其中，令</p>

<p>\begin{align}
P(\sigma^2) =Inv-Gamma(\frac{v_0}{2}, \frac{v_0s_0^2}{2}) \propto \sigma^{-(v_0+2)}exp\left( -\frac{v_0s_0^2}{2\sigma^2} \right)
\end{align}</p>

<p>设定<script type="math/tex">a_0=\frac{v_0}{2},b_0=\frac{v_0s_0^2}{2}</script>，于是</p>

<p>\begin{align}
P(\sigma^2) \propto \sigma^{-(2a_0+2)}exp\left( -\frac{b_0}{\sigma^2} \right)
\end{align}</p>

<p>而另一个条件概率设定为高斯分布，式中的<script type="math/tex">\mu_0,\Lambda_0</script>为先验值</p>

<p>\begin{align}
P(\beta |\sigma^2) \propto \sigma^{-k}exp\left( -\frac{(\beta-\mu_0)^T\Lambda_0(\beta - \mu_0)}{2\sigma^2} \right)
\end{align}</p>

<h2 id="section-2">3. 后验</h2>

<p>有了先验和似然，可以开始计算后验了，根据贝叶斯公式</p>

<p>\begin{align}
P(\beta,\sigma^2|y,X) &amp;\propto P(y|X,\beta,\sigma^2)P(\beta|\sigma^2)P(\sigma^2) \\
&amp; \propto \left[\sigma^{-n}exp\left(-\frac{(y-X\beta)^T(y-X\beta)}{2\sigma^2}\right)\right]\left[\sigma^{-k}exp\left( -\frac{(\beta-\mu_0)^T\Lambda_0(\beta - \mu_0)}{2\sigma^2} \right)\right] \\
&amp;* \left[\sigma^{-(2a_0+2)}exp\left( -\frac{b_0}{\sigma^2} \right)\right]
\end{align}</p>

<p>由于</p>

<p>\begin{align}
(y-X\beta)^T(y-X\beta) + (\beta-\mu_0)^T\Lambda_0(\beta - \mu_0) = (\beta-\mu_n)^T(X^TX+\Lambda_0)(\beta - \mu_n) + y^Ty - \mu_n^T(X^TX+\Lambda_0)\mu_n + \mu_0^T\Lambda_0\mu_0
\end{align}</p>

<p>式中<script type="math/tex">\mu_n = (X^TX + \Lambda_0)^{-1}(X^TX\hat{\beta} + \Lambda_0\mu_0)</script>，由上式也可以看出<script type="math/tex">\mu_n</script>就是<script type="math/tex">\beta</script>的后验均值</p>

<p>使用<script type="math/tex">\mu_n</script>，可以整理后验概率如下</p>

<p>\begin{align}
P(\beta,\sigma^2|y,X) \propto \left[\sigma^{-k}exp\left( -\frac{(\beta-\mu_n)^T(X^TX + \Lambda_0)(\beta-\mu_n)}{2\sigma^2} \right)\right] \left[\sigma^{-n-2a_0-2} exp \left( -\frac{2b_0 + y^Ty - \mu_n^T(X^TX + \Lambda_0)\mu_n+\mu_0^T\Lambda_0\mu_0}{2\sigma^2} \right)\right]
\end{align}</p>

<p>可以看到后验概率整理成一个高斯分布<script type="math/tex">N(\mu_n,\sigma^2\Lambda_n^{-1})</script>乘上一个逆伽马分布<script type="math/tex">Inv-Gamma(a_n,b_n)</script>，与先验概率的形式保持一致</p>

<p>由整理后的式子容易得到</p>

<p>\begin{align}
\mu_n &amp;= (X^TX + \Lambda_0)^{-1}(\Lambda_0\mu_0 + X^Ty) \\
\Lambda_n &amp;= X^TX + \Lambda_0 \\
a_n &amp;= a_0 + \frac{n}{2} \\
b_n &amp;= b_0 + \frac{y^Ty+\mu_0^T\Lambda_0\mu_0-\mu_n^T\Lambda_n\mu_n}{2}
\end{align}</p>

<p>也就是</p>

<p>\begin{align}
P(\beta,\sigma^2|y,X) \propto \left[\sigma^{-k}exp\left( -\frac{(\beta-\mu_n)^T\Lambda_n(\beta-\mu_n)}{2\sigma^2} \right)\right] \left[(\sigma^2)^{-a_n-1} exp \left( -\frac{b_n}{\sigma^2} \right)\right]
\end{align}</p>

<h2 id="ridge-regression">4. Ridge Regression</h2>

<p>当<script type="math/tex">\mu_0=0,\Lambda_0=cI</script>时称为Ridge Regression</p>

<p>式中的<script type="math/tex">c \in R</script></p>
